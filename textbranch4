text4 added, modifications from branch2